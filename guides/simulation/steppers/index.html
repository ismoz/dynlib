
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python library for simulating dynamical systems.">
      
      
        <meta name="author" content="İsmail Öztürk">
      
      
        <link rel="canonical" href="https://ismoz.github.io/dynlib/guides/simulation/steppers/">
      
      
        <link rel="prev" href="../results/">
      
      
        <link rel="next" href="../snapshots-and-resume/">
      
      
        
          <link rel="alternate" href="./" hreflang="en">
        
          <link rel="alternate" href="../../../tr/guides/simulation/steppers/" hreflang="tr">
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Steppers - dynlib</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#steppers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="dynlib" class="md-header__button md-logo" aria-label="dynlib" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dynlib
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Steppers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../tr/guides/simulation/steppers/" hreflang="tr" class="md-select__link">
              Türkçe
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../getting-started/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../examples/" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../reference/" class="md-tabs__link">
          
  
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../project/changelog/" class="md-tabs__link">
          
  
  
  Project

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="dynlib" class="md-nav__button md-logo" aria-label="dynlib" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    dynlib
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting started with dynlib
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/first-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Your First Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Modeling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modeling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modeling guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/dsl-basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DSL basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/equations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Equations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/math-and-macros/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Math & macros
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/ternary-if/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ternary if
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/model-registry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model registry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/aux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Auxiliary variables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DSL functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/lagging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lagging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/inline-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inline models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/config-file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Config file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/mods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/presets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Presets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/sim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simulation defaults
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Simulation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Simulation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simulation guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Just-In-Time compilation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../presets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Presets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runner-variants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runner variants
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../session-introspection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Session introspection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../results/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Results
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Steppers
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Steppers
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#choosing-a-stepper" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing a Stepper
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#available-steppers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Available Steppers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepper-registry-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stepper Registry &amp; Discovery
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stepper Registry &amp; Discovery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stepper-metadata-fields" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stepper metadata fields
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stepper-capability-flags-steppercaps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stepper capability flags (StepperCaps)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepper-workspace" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stepper Workspace
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stepper Workspace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key characteristics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-workspace-layouts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example workspace layouts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example workspace layouts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#euler-workspace" class="md-nav__link">
    <span class="md-ellipsis">
      
        Euler workspace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rk4-workspace" class="md-nav__link">
    <span class="md-ellipsis">
      
        RK4 workspace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rk45-workspace-adaptive" class="md-nav__link">
    <span class="md-ellipsis">
      
        RK45 workspace (adaptive)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#workspace-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Workspace allocation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-every-stepper-needs-rhs-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why every stepper needs RHS arrays
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#runtime-workspace" class="md-nav__link">
    <span class="md-ellipsis">
      
        Runtime Workspace
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Runtime Workspace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Structure
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workspace-design-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Workspace design benefits
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepper-abi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stepper ABI
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workspace-serialization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Workspace Serialization
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variational-stepping-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Variational Stepping Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-steppers-developer-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extending Steppers (Developer Guide)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extending Steppers (Developer Guide)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-define-the-metadata-and-capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Define the metadata and capabilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-implement-the-spec-use-configmixin-when-you-need-runtime-knobs" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Implement the spec (use ConfigMixin when you need runtime knobs)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-workspace-combinatorial-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Workspace &amp; combinatorial helpers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-register-the-spec" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Register the spec
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-testing-and-cli-visibility" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Testing and CLI visibility
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snapshots-and-resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Snapshots & resume
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wrapper-and-runner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Wrapper & runner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../export-sources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exporting sources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Plotting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Plotting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plotting guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plotting basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/decorations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decorations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/export/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exporting plots
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/cobweb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cobweb plots
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/basin-plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basin plots
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/vectorfields/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vector fields
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/manifold-plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manifold plots
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/themes-and-facets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Themes & facets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/bifurcation-diagrams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bifurcation diagrams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Analysis
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Analysis
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Analysis guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/observers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime observers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/lyapunov/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lyapunov analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/sweep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sweep utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/post-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Post-analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/fixed-points/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fixed points
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/basin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basin analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/bifurcation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bifurcation diagrams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/manifold/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manifold analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Analysis catalog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/plotting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plotting catalog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/runtime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime catalog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/state-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    State management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/bifurcation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bifurcation logistic map
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/integer-map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collatz conjecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/izhikevich/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Izhikevich neuron
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Built-in models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Project
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Project
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../project/changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../project/issues/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Issues
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../project/todo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TODO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="steppers">Steppers</h1>
<p><code>dynlib</code> uses steppers to advance one simulation step. They are mostly integrators but they are not called integrators or solvers because a map type stepper is used to advance discrete maps. Also ODE integrators / solvers might not be suitable for future dynamical system types. Choose the stepper that matches your problem class (ODE vs map), time-control strategy (fixed vs adaptive), and numerical scheme (explicit, implicit, splitting). You can override the model default via <code>build(..., stepper="rk4")</code> or, for the fast path in application code, <code>setup(..., stepper="rk4")</code>. Every compiled <code>Model</code> or <code>Sim</code> surface exposes <code>model.stepper_name</code> so you can confirm which integrator was selected after compilation.</p>
<h2 id="choosing-a-stepper">Choosing a Stepper</h2>
<p>There are three axes you should always check before running a simulation:</p>
<ul>
<li><strong>Kind</strong> (<code>Kind = "ode" | "map"</code>) describes the mathematical nature of the stepper. ODE steppers expect an RHS <code>f(t, y)</code> and multiply by <code>dt</code>, while the <code>map</code> stepper treats the compiled callable as a discrete update that already returns the next state (dt is only a label).</li>
<li><strong>Time control</strong> (<code>TimeCtrl = "fixed" | "adaptive"</code>) determines whether the integrator advances with a constant <code>dt</code> or internally retries and resizes the step. Adaptive steppers (RK45, BDF2a, TR-BDF2a) expose <code>atol/rtol</code> tolerant controls, while fixed-step steppers rely on the driver <code>Sim.run()</code> arguments.</li>
<li><strong>Scheme</strong> (<code>Scheme = "explicit" | "implicit" | "splitting"</code>) is the algebraic structure of the method. Explicit steppers have no nonlinear solves, whereas implicit steppers (SDIRK2, BDF2, BDF2a, TR-BDF2a) call Newton iterations and usually support optional analytic Jacobians. Splitting schemes will show up in the future.</li>
</ul>
<p>The combination of these axes plus the <code>family</code>/<code>order</code> metadata in each <code>StepperMeta</code> gives you a concise view of what is physically happening. If you need Jacobians, dense output, or variational stepping for Lyapunov analysis, look at the <code>StepperCaps</code> block (in the docs we expose <code>dense_output</code>, <code>jacobian</code>, <code>jit_capable</code>, <code>requires_scipy</code>, and <code>variational_stepping</code> flags).</p>
<h2 id="available-steppers">Available Steppers</h2>
<p>| Name      | Kind | Time control | Scheme | Order | Key notes |
| <code>map</code>     | map | fixed    | explicit | 1  | Discrete iterates (<code>F(t, y)</code> returns next state). <code>dt</code> only labels time. |
| <code>euler</code>   | ode | fixed    | explicit | 1  | Forward Euler, minimal workspace, variational-stepping capable. |
| <code>rk2</code>     | ode | fixed    | explicit | 2  | Explicit midpoint (RK2) with simple 2-stage update and variational support. |
| <code>rk4</code>     | ode | fixed    | explicit | 4  | Classic Runge–Kutta 4th order, alias <code>rk4_classic</code>, <code>classical_rk4</code>. |
| <code>rk45</code>    | ode | adaptive | explicit | 5¹ | Dormand–Prince RK45 with embedded order 4 error estimate. |
| <code>ab2</code>     | ode | fixed    | explicit | 2  | Adams–Bashforth 2 multistep with Heun startup, maintains derivative history. |
| <code>ab3</code>     | ode | fixed    | explicit | 3  | Adams–Bashforth 3 with a two-step startup that hands control over to the multistep loop. |
| <code>sdirk2</code>  | ode | fixed    | implicit | 2  | Alexander SDIRK2 (γ = (2−√2)/2), stiffly accurate but requires Jacobians. |
| <code>bdf2</code>    | ode | fixed    | implicit | 2  | Implicit BDF2 with Newton solver; optionally accepts external Jacobians. |
| <code>bdf2a</code>   | ode | adaptive | implicit | 2  | Variable-step BDF2 with error estimation. |
| <code>tr-bdf2a</code>| ode | adaptive | implicit | 2  | TR-BDF2 adaptive integrator (L-stable, BE partner) with the same config knobs as <code>bdf2a</code>. |</p>
<p>¹ Embedded order: 4 (error estimate). Adaptive steppers override <code>dt</code> internally but still report <code>dt_next</code> for the runner.</p>
<p>Each canonical stepper name is registered once; aliases such as <code>forward_euler</code>, <code>rk4_classic</code>, <code>trbdf2a</code>, and <code>sdirk2_jit</code> are automatically mapped to the same spec. Use the canonical name to avoid surprises when sharing configs or presets.</p>
<p>For maps you don't have to explicitly define <code>stepper=map</code>. For ODE models <code>rk4</code> is the default stepper.</p>
<h2 id="stepper-registry-discovery">Stepper Registry &amp; Discovery</h2>
<p>The stepper registry is both user-facing and developer-facing. It is populated automatically when the stepper modules import, but you can also register custom specs with <code>dynlib.register()</code> if you need a specialized method.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dynlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">list_steppers</span><span class="p">,</span> <span class="n">select_steppers</span><span class="p">,</span> <span class="n">get_stepper</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">list_steppers</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;ode&quot;</span><span class="p">))</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">infos</span> <span class="o">=</span> <span class="n">select_steppers</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;implicit&quot;</span><span class="p">,</span> <span class="n">stiff</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">jit_capable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nb">print</span><span class="p">([</span><span class="n">info</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">infos</span><span class="p">])</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">spec</span> <span class="o">=</span> <span class="n">get_stepper</span><span class="p">(</span><span class="s2">&quot;rk45&quot;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nb">print</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">spec</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">aliases</span><span class="p">)</span>
</code></pre></div>
<p><code>list_steppers()</code> returns sorted canonical names and accepts the same keyword filters as <code>select_steppers()</code> (kind, scheme, stiff, jit_capable, etc.). <code>select_steppers()</code> yields <code>StepperInfo</code> instances (aliased to <code>StepperMeta</code>), and you can also pass <code>name_pattern</code> or a custom <code>predicate</code> for fine-grained discovery (e.g., look for options that support variational stepping or dense-output).</p>
<p>The CLI mirrors the Python API: <code>dynlib steppers list</code> prints the same canonical names, and available flags mirror the keyword filters you saw above so you can narrow the output (for example by kind or scheme).</p>
<h3 id="stepper-metadata-fields">Stepper metadata fields</h3>
<ul>
<li><code>name</code>: canonical stepper name (aliases resolve to this spec).</li>
<li><code>kind</code>: <code>ode</code> vs <code>map</code>.</li>
<li><code>time_control</code>: <code>fixed</code> or <code>adaptive</code>.</li>
<li><code>scheme</code>: <code>explicit</code>, <code>implicit</code>, or <code>splitting</code>.</li>
<li><code>geometry</code>: reserved set for geometry-aware methods (currently empty for built-in steppers).</li>
<li><code>family</code>: classification such as <code>runge-kutta</code>, <code>adams-bashforth</code>, <code>bdf</code>, <code>dirk</code>, <code>tr-bdf2</code>, or <code>iter</code>.</li>
<li><code>order</code>, <code>embedded_order</code>: describe the primary and embedded accuracy.</li>
<li><code>stiff</code>: indicates whether the method is intended for stiff problems.</li>
<li><code>aliases</code>: other names that map to the canonical spec.</li>
<li><code>caps</code>: see below.</li>
</ul>
<h3 id="stepper-capability-flags-steppercaps">Stepper capability flags (<code>StepperCaps</code>)</h3>
<ul>
<li><code>dense_output</code>: supports continuous interpolation / dense output (currently False for built-ins).</li>
<li><code>jacobian</code>: <code>"none" | "internal" | "optional" | "required"</code> describes how the stepper consumes external Jacobians.</li>
<li><code>jit_capable</code>: true for all built-in steppers; false if the method relies on foreign dependencies.</li>
<li><code>requires_scipy</code>: true if SciPy is needed.</li>
<li><code>variational_stepping</code>: indicates support for <code>emit_step_with_variational()</code> (used in Lyapunov analysis).</li>
</ul>
<p>The registry helpers (<code>list_steppers</code>, <code>select_steppers</code>) accept these metadata fields as filters. For example, <code>select_steppers(kind="ode", variational_stepping=True)</code> returns only ODE steppers that also implement the variational interface.</p>
<h2 id="stepper-workspace">Stepper Workspace</h2>
<p>The stepper workspace is a private, stepper-specific scratch area that lives alongside the runtime metadata. Each stepper defines a NamedTuple that describes the arrays it needs during a single step. The workspace is allocated once per simulation via the stepper’s <code>make_workspace(n_state, dtype)</code> hook and reused for every step.</p>
<h3 id="key-characteristics">Key characteristics</h3>
<ul>
<li><strong>Ownership</strong>: private to each stepper spec and passed as <code>stepper_ws</code> to the ABI.</li>
<li><strong>Lifetime</strong>: persistent until the <code>Sim</code> is destroyed or the workspace memory is explicitly freed.</li>
<li><strong>Content</strong>: NumPy arrays, e.g., stage buffers, derivative histories, Jacobian scratch, Newton guesses.</li>
<li><strong>Allocation</strong>: driven by the stepper’s <code>workspace_type()</code> and <code>make_workspace()</code>.</li>
<li><strong>Type</strong>: a <code>NamedTuple</code> so fields are accessed by name instead of by index.</li>
</ul>
<h3 id="example-workspace-layouts">Example workspace layouts</h3>
<h4 id="euler-workspace">Euler workspace</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Workspace</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="n">dy</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">kv</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>
<h4 id="rk4-workspace">RK4 workspace</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Workspace</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="n">y_stage</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">k1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="n">k2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">k3</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    <span class="n">k4</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="n">v_stage</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    <span class="n">kv1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>    <span class="n">kv2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    <span class="n">kv3</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    <span class="n">kv4</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>
<h4 id="rk45-workspace-adaptive">RK45 workspace (adaptive)</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Workspace</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="n">y_stage</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="n">k1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">k2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">k3</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">k4</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">k5</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="n">k6</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="n">k7</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>
<h3 id="workspace-allocation">Workspace allocation</h3>
<p>Steppers implement <code>make_workspace(n_state, dtype, model_spec=None)</code> to instantiate the NamedTuple and zero-initialize the arrays. The <code>workspace_type()</code> hook informs tooling (e.g., the compiler) how to pack the workspace into serialized snapshots, and <code>variational_workspace()</code> is available when the stepper supports Lyapunov/variational analysis.</p>
<h3 id="why-every-stepper-needs-rhs-arrays">Why every stepper needs RHS arrays</h3>
<p>Whatever the scheme, the stepper needs to store one or more evaluations of <code>f(t, y)</code> so it can combine them into a proposal. The workspace keeps these RHS buffers (<code>dy</code> for Euler, <code>k1..k4</code> for RK4, <code>f_prev/f_curr</code> for AB2/AB3, Newton residuals for implicit steppers). Every method writes the derivative vectors into its own slots, then assembles <code>y_prop</code>, <code>t_prop</code>, <code>dt_next</code>, and <code>err_est</code>.</p>
<h2 id="runtime-workspace">Runtime Workspace</h2>
<p>The runtime workspace handles lag buffers and other DSL machinery state, separate from stepper scratch space.</p>
<h3 id="structure">Structure</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">RuntimeWorkspace</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="s2">&quot;RuntimeWorkspace&quot;</span><span class="p">,</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="p">[</span><span class="s2">&quot;lag_ring&quot;</span><span class="p">,</span> <span class="s2">&quot;lag_head&quot;</span><span class="p">,</span> <span class="s2">&quot;lag_info&quot;</span><span class="p">],</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>lag_ring</code>: circular buffer storing historical state snapshots.</li>
<li><code>lag_head</code>: current head indices used for each lagged state.</li>
<li><code>lag_info</code>: metadata describing the layout of each lag (state index, depth, offset).</li>
</ul>
<p>Lag buffers are accessed with runtime helpers inside generated code, e.g.:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">prev_x</span> <span class="o">=</span> <span class="n">lag_value</span><span class="p">(</span><span class="n">runtime_ws</span><span class="p">,</span> <span class="n">state_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lag_steps</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h2 id="workspace-design-benefits">Workspace design benefits</h2>
<ul>
<li><strong>Separation of concerns</strong>: stepper scratch stays isolated from runtime metadata.</li>
<li><strong>Type safety</strong>: NamedTuple workspaces carry descriptive field names instead of numeric offsets.</li>
<li><strong>Flexibility</strong>: each stepper shapes its workspace to exactly the buffers it needs.</li>
<li><strong>Safety</strong>: runtime workspaces reserve their own head slots, so lag buffers never interfere with stepper scratch.</li>
</ul>
<h2 id="stepper-abi">Stepper ABI</h2>
<p>The compiled stepper callable follows a fixed ABI so the runner and results infrastructure can stay generic. The signature is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">status</span> <span class="o">=</span> <span class="n">stepper</span><span class="p">(</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="n">y_curr</span><span class="p">:</span> <span class="nb">float</span><span class="p">[:],</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="n">rhs</span><span class="p">,</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="n">params</span><span class="p">:</span> <span class="nb">float</span><span class="p">[:]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">[:],</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    <span class="n">runtime_ws</span><span class="p">,</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    <span class="n">stepper_ws</span><span class="p">,</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    <span class="n">stepper_config</span><span class="p">:</span> <span class="n">float64</span><span class="p">[:],</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>    <span class="n">y_prop</span><span class="p">:</span> <span class="nb">float</span><span class="p">[:],</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>    <span class="n">t_prop</span><span class="p">:</span> <span class="nb">float</span><span class="p">[:],</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>    <span class="n">dt_next</span><span class="p">:</span> <span class="nb">float</span><span class="p">[:],</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="n">err_est</span><span class="p">:</span> <span class="nb">float</span><span class="p">[:],</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">int32</span>
</code></pre></div>
<ul>
<li><code>rhs</code>: compiled RHS function the stepper repeatedly invokes.</li>
<li><code>runtime_ws</code>: shared runtime workspace for lag buffers and metadata.</li>
<li><code>stepper_ws</code>: the Active stepper workspace described above.</li>
<li><code>stepper_config</code>: config array packed from the stepper’s dataclass (use <code>pack_config()</code>).</li>
<li><code>y_prop</code>, <code>t_prop</code>, <code>dt_next</code>, <code>err_est</code>: output buffers that the runner consumes after each call.</li>
</ul>
<p>Adaptive steppers rewrite <code>dt_next</code> and <code>err_est</code> before the runner accepts the step, while fixed-step steppers usually write the current <code>dt + t</code> and zero error.</p>
<h2 id="workspace-serialization">Workspace Serialization</h2>
<p>Stepper workspaces are serializable so you can snapshot a running simulation and restore it later. Use the helper functions that capture the workspace arrays when taking a snapshot:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">snapshot</span> <span class="o">=</span> <span class="n">snapshot_workspace</span><span class="p">(</span><span class="n">stepper_ws</span><span class="p">)</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">restore_workspace</span><span class="p">(</span><span class="n">stepper_ws</span><span class="p">,</span> <span class="n">snapshot</span><span class="p">)</span>
</code></pre></div>
<p>Snapshots capture both the runtime workspace and the stepper workspace so you can pause, rewind, or branch simulations with exact stepper state.</p>
<h2 id="variational-stepping-overview">Variational Stepping Overview</h2>
<p>Some steppers support a combined state + tangent integration path that is useful for Lyapunov, sensitivity, or variational analyses. Look for <code>StepperSpec</code> implementations that set <code>StepperCaps(variational_stepping=True)</code>; they expose a <code>variational_workspace()</code> hook and <code>emit_step_with_variational()</code> method. Those facilities keep extra tangent buffers next to the state workspace, let you invoke the Jacobian-vector product (<code>jvp_fn</code>) in lockstep with the state RHS, and keep the tangent state synchronized with <code>y_prop</code>. When you need Lyapunov exponents or other variational diagnostics, choose one of these steppers (Euler, RK2, RK4, RK45, AB2, AB3, etc.) and call the variational stepping helpers rather than manually chaining the state and tangent integrators.</p>
<h2 id="extending-steppers-developer-guide">Extending Steppers (Developer Guide)</h2>
<p>For contributors who need a custom integrator or map, the <code>dynlib</code> stepper stack is intentionally modular. A new stepper spec simply implements the <code>StepperSpec</code> protocol, registers itself, and optionally exposes runtime configuration via <code>ConfigMixin</code>.</p>
<h3 id="1-define-the-metadata-and-capabilities">1. Define the metadata and capabilities</h3>
<ul>
<li>Create a <code>StepperMeta</code> that describes the new method: canonical <code>name</code>, <code>kind</code>, <code>time_control</code>, <code>scheme</code>, <code>family</code>, <code>order</code>, <code>stiff</code>, and any <code>aliases</code>.</li>
<li>Provide a <code>StepperCaps</code> instance that advertises optional behaviors (<code>dense_output</code>, <code>jacobian</code>, <code>jit_capable</code>, <code>requires_scipy</code>, <code>variational_stepping</code>). These flags are used by <code>select_steppers()</code>/<code>list_steppers()</code> and CLI filters, so set them truthfully for tooling discoverability.</li>
</ul>
<h3 id="2-implement-the-spec-use-configmixin-when-you-need-runtime-knobs">2. Implement the spec (use <code>ConfigMixin</code> when you need runtime knobs)</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>class MyStepperSpec(ConfigMixin):
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    @dataclass
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>    class Config:
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>        tol: float = 1e-6
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>        max_iter: int = 20
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>        __enums__ = {&quot;method&quot;: {&quot;foo&quot;: 0, &quot;bar&quot;: 1}}
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>    def __init__(self, meta: StepperMeta | None = None):
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>        self.meta = meta or StepperMeta(
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>            name=&quot;my_stepper&quot;,
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>            kind=&quot;ode&quot;,
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>            time_control=&quot;fixed&quot;,
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>            scheme=&quot;explicit&quot;,
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>            family=&quot;custom&quot;,
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>            order=2,
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>            stiff=False,
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>            caps=StepperCaps(jit_capable=True, variational_stepping=True),
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>        )
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>    def workspace_type(self) -&gt; type | None:
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>        return MyStepperWorkspace
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>    def make_workspace(...):
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>        ...
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>    def emit(...):
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>        ...
</code></pre></div>
<ul>
<li><code>ConfigMixin</code> automatically implements <code>config_spec()</code>, <code>default_config()</code>, <code>pack_config()</code> and <code>config_enum_maps()</code> based on the nested <code>Config</code> dataclass, so you only need to declare the fields you care about.</li>
<li>Inside <code>emit</code>, read <code>stepper_config</code> (packed float array) to apply runtime overrides, defaulting to <code>default_config(model_spec)</code> for values left unspecified by the user.</li>
</ul>
<h3 id="3-workspace-combinatorial-helpers">3. Workspace &amp; combinatorial helpers</h3>
<ul>
<li>Describe the workspace layout as a <code>NamedTuple</code> with NumPy arrays for stage buffers, histories, Jacobian scratch, or Newton residuals. <code>workspace_type()</code> exposes this layout, while <code>make_workspace(n_state, dtype)</code> zero-initializes the buffers.</li>
<li>If the stepper supports Lyapunov/variational analysis, implement <code>variational_workspace()</code> to describe the analysis scratch (see <code>EulerSpec.variational_workspace()</code> for a pattern).</li>
</ul>
<h3 id="4-register-the-spec">4. Register the spec</h3>
<p>Register the stepper with the global registry so it becomes discoverable to <code>build()</code>, <code>setup()</code>, and <code>dynlib steppers list</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dynlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">register</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">register</span><span class="p">(</span><span class="n">MyStepperSpec</span><span class="p">())</span>
</code></pre></div>
<p>Call <code>register()</code> once (typically at module import time) using the canonical spec instance. Canonical names and aliases are deduplicated by the registry helpers.</p>
<h3 id="5-testing-and-cli-visibility">5. Testing and CLI visibility</h3>
<ul>
<li>Prepare tests like <code>test_&lt;stepper_name&gt;_basic.py</code> or add the stepper into the parameter list of existing tests like <code>test_ode_stepper_contract.py</code>.</li>
<li>Update the CLI or presets if you want the stepper to appear in <code>dynlib steppers list</code> examples.</li>
</ul>
<p>Following this flow keeps user-visible metadata, config, ABI, and workspace wiring aligned with the built-in steppers, making your custom integrator pluggable into the existing tooling.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ismoz/dynlib" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/dynlib/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy", "content.code.math"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>